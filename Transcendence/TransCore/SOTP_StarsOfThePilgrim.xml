<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE TranscendenceAdventure
	[
	<!-- 0020xxxx THE STARS OF THE PILGRIM ADVENTURE ======================= -->
	
	<!-- 0000-000F CORE/COMPATIBILITY -->
	
	<!ENTITY SOTP_unidStarsOfThePilgrim		"0x00200000">
	<!-- HUMAN SPACE LIBRARY 0x00200001 -->
	<!-- HUMAN SPACE LIBRARY 0x00200002 -->
	<!-- HUMAN SPACE LIBRARY 0x00200003 -->
	<!ENTITY SOTP_unidPartISystemMap			"0x00200004">
	<!ENTITY SOTP_msReachGalacticCore		"0x00200005">
	<!ENTITY SOTP_unidBenedictStoryArc		"0x00200006">
	<!ENTITY SOTP_dsBenedictIntro			"0x00200007">
	<!ENTITY SOTP_msBenedictsDrones			"0x00200008">
	<!ENTITY SOTP_msBenedictAndFiona			"0x00200009">
	<!-- UNUSED 0x0020000A -->
	<!ENTITY SOTP_msBenedictToKorolov		"0x0020000B">
	<!ENTITY SOTP_msBenedictTraining			"0x0020000C">
	<!ENTITY SOTP_rsGalacticCoreMissionTile	"0x0020000D">
	<!ENTITY SOTP_unidAchievements			"0x0020000E">
	
	<!-- 0010-005F BENEDICT MISSION ARC -->
	
	<!ENTITY SOTP_msBenedictInNewBeyond		"0x00200010">
	<!ENTITY SOTP_tbBenedict04Encounters		"0x00200011">
	<!ENTITY SOTP_msFionaInStKats			"0x00200012">
	<!ENTITY SOTP_msFindHandOfSolace			"0x00200013">
	<!ENTITY SOTP_stHandOfSolaceWreck		"0x00200014">
	<!ENTITY SOTP_ovBenedict05ScanRange		"0x00200015">
	<!ENTITY SOTP_tbBenedict05Encounters		"0x00200016">
	<!ENTITY SOTP_msInfiltratePenitents		"0x00200017">
	<!ENTITY SOTP_svBenedict06Infiltrate		"0x00200018">
	<!ENTITY SOTP_evBenedict06PenitentBase	"0x00200019">
	<!ENTITY SOTP_ovBenedict06Disarm			"0x0020001A">
	<!ENTITY SOTP_msRescueBenedict			"0x0020001B">
	<!ENTITY SOTP_evBenedict07PenitentWreck	"0x0020001C">
	<!ENTITY SOTP_msRescueChildrenFromPenitents	"0x0020001D">
	<!ENTITY SOTP_evBenedict08PenitentBase	"0x0020001E">
	<!ENTITY SOTP_evBenedict07FionaWreck		"0x0020001F">
	<!ENTITY SOTP_evBenedict06PenitentShip	"0x00200020">
	<!ENTITY SOTP_evBenedict07Wingman		"0x00200021">
	<!ENTITY SOTP_evBenedict02FionaWreck		"0x00200022">
	<!ENTITY SOTP_baBenedictMission			"0x00200023">
	<!ENTITY SOTP_rsBenedictMission			"0x00200024">
	<!ENTITY SOTP_evBenedict05ASandoval		"0x00200025">

	<!-- 0060-007F HERETIC MISSION ARC -->
	
	<!ENTITY SOTP_msHereticIocrymAttack		"0x00200060">
	<!ENTITY SOTP_msHereticIocrymAttackMsg	"0x00200061">
	<!ENTITY SOTP_msHereticSvalbard			"0x00200062">
	<!ENTITY SOTP_dsHereticSvalbardDonate	"0x00200063">
	<!ENTITY SOTP_msHereticControlPoint		"0x00200064">
	<!ENTITY SOTP_msHereticFurtherResearch	"0x00200065">
	<!ENTITY SOTP_msHereticSettlement		"0x00200066">
	<!ENTITY SOTP_msHereticMaryamsArchive	"0x00200067">
	<!ENTITY SOTP_stMaryamsArchive			"0x00200068">
	<!ENTITY SOTP_msHereticHuygensExplorer	"0x00200069">
	<!ENTITY SOTP_evHereticHuygensExplorer	"0x0020006A">
	<!ENTITY SOTP_msHereticIocrymArtifact	"0x0020006B">
	<!ENTITY SOTP_msHereticIocrymOutpost		"0x0020006C">
	<!ENTITY SOTP_msHereticMRADExperiment	"0x0020006D">

	<!-- 0080-00BF MISCELLANEOUS MISSIONS -->

	<!ENTITY SOTP_msPsychEval01				"0x00200080">
	<!ENTITY SOTP_msPsychEval00				"0x00200081">

	<!-- 0021xxxx HUARI ==================================================== -->
	
	<!ENTITY SOTP_smHuariSpace				"0x00210001">
	<!ENTITY SOTP_msHuaramarcaTuali			"0x00210002">
	<!ENTITY SOTP_msHuaramarcaDreamTest		"0x00210003">
	<!ENTITY SOTP_msHuaramarcaDefendTemple	"0x00210004">
	<!ENTITY SOTP_msHuaramarcaAttackBase		"0x00210005">
	<!ENTITY SOTP_msHuaramarcaDragonSlaver	"0x00210006">
	<!ENTITY SOTP_msHuaramarcaArchcannon		"0x00210007">
	<!ENTITY SOTP_msHuaramarcaRevelation		"0x00210008">

	<!-- 0082xxxx PART I SOUNDTRACK ======================================== -->

	<!ENTITY muDominaMainTheme			"0x00820020">
	<!ENTITY muDominaEndTitles01		"0x00820120">
	]>
	
<TranscendenceAdventure
		UNID=				"&SOTP_unidStarsOfThePilgrim;"
		name=				"Domina &amp; Oracus I: The Stars of the Pilgrim"
		release=			"1" 
		>
	
	<Library unid="&CORE_unidCoreTypesLibrary;"/>
	<Library unid="&RPG_unidRPGLibrary;"/>
	<Library unid="&GLXY_unidGalaxyLibrary;"/>
	<Library unid="&HS_unidHumanSpaceLibrary;"/>

	<AdventureDesc
			unid=			"&HS_adPart1Desc;"
			backgroundID=	"&HS_rsPart1Cover;"
			inherit=		"&RPG_unidCommonText;"
				
			startingShipCriteria=	"* +00200000_PlayerShip;"
			include10StartingShips=	"true" 
			startingSystem=			"SE"
			startingPos=			"Start"
			>

		<Properties>
			<!--
				This is needed by trnCreateAllStargates (which is used by all 
				standard systems) to figure out which node is closest to the
				Galactic Core. This allows us to create inbound vs. outbound
				stargates.
			-->
			<Constant id="core.defaultCorewardNode">		'G2</Constant>

			<Constant id="core.defaultInteraction">			Nil</Constant>
			<Constant id="core.defaultShotHP">				Nil</Constant>
			<Constant id="core.hideDisintegrationImmune">	Nil</Constant>
			<Constant id="core.hideIonizeImmune">			Nil</Constant>
			<Constant id="core.hideRadiationImmune">		Nil</Constant>
			<Constant id="core.hideShatterImmune">			Nil</Constant>
		</Properties>
		
		<EncounterOverrides>
			<!-- NOTE: We have 1 guaranteed station (in BA), so this will 
				usually be a second guaranteed station. -->

			<Encounter unid="&HS_stBlackMarketStation;"	minAppearing="1"/>

			<Encounter unid="&HS_stRasiermesserFactory;"	minAppearing="1"/>
			<Encounter unid="&HS_stTinkerGathering;"		minAppearing="1"/>
		</EncounterOverrides>

		<Events>
			<OnGameStart>
				(block Nil
					(gamSetCrawlImage &HS_rsProlog1;)
					(gamSetCrawlSoundtrack &muDominaMainTheme;)
					(gamSetCrawlText (typTranslate gType 'openingCrawl))
					)
			</OnGameStart>

			<OnGameEnd>
				(block Nil
					(gamSetCrawlImage
						(if (eq aEndGameReason 'leftHumanSpace)
							&HS_rsEndGameEscaped;
							&HS_rsEndGameDestroyed;
							)
						)

					(gamSetCrawlSoundtrack &muDominaEndTitles01;)

					(gamSetCrawlText 
						(cat
							(typTranslate &RPG_unidCommonText; 'epitaph {
								epitaph: aEpitaph
								systemsVisited: aSystemsVisited
								enemiesDestroyed: aEnemiesDestroyed
								bestEnemiesDestroyed: aBestEnemiesDestroyed
								bestEnemyClass: aBestEnemyClass
								})
							"\n\n"
							(if (= aEndGameReason 'leftHumanSpace)
								(typTranslate gType 'lastPhrase.continued)
								(typTranslate gType 'lastPhrase.never)
								)
							)
						)

					;	Achievement

					(if (= aEndGameReason 'leftHumanSpace)
						(unvSetAchievement (cat 'sotp.completed. (unv@ 'difficulty)))
						)
					)
			</OnGameEnd>

			<GetGlobalAchievements>
				(append
					(intGetGlobalAchievements)

					(switch
						(= aEndGameReason 'leftHumanSpace)
							{	descID: 'achieve.leftHumanSpace
								sectionID: 'exploration
								sort: 'Z006
								}

						{	descID: 'achieve.neverLeftHumanSpace
							sectionID: 'exploration
							sort: 'Z006
							}
						)
					)
			</GetGlobalAchievements>
				
			<OnGlobalUniverseCreated>
				(block (theMission)

					; Give the "Reach the Galactic Core" mission to the player

					(setq theMission (msnCreate &SOTP_msReachGalacticCore; Nil))
					(if theMission
						(msnAccept theMission)
						)
					)
			</OnGlobalUniverseCreated>
		</Events>

		<Language>
			<RTF id="description">
				{/rtf
					Called by Domina to journey to the Galactic Core, you 
					leave the safe environs of your home system and explore the
					farthest reaches of Human Space.

					But dangers stalk your passage and even Domina's protection 
					is no guarantee, for none who have been called have yet 
					returned.

					Will your pilgrimage be more successful?
				}
			</RTF>
			<Text id="openingCrawl">

				When the dream came, you knew Domina had chosen you. You would 
				sacrifice everything for the chance She offered: to join Her at 
				the Galactic Core, the eternal temple of the gods.

				Leaving your former life behind, you begin the long journey. No
				matter what obstacles lie in your path you will not fail Domina. 
				You will reach the Galactic Core.

			</Text>
			<Text id="lastPhrase.continued">To be continued...</Text>
			<Text id="lastPhrase.never">%He% never reached the Galactic Core.</Text>

			<Text id="achieve.leftHumanSpace">Left Human Space</Text>
			<Text id="achieve.neverLeftHumanSpace">Never left Human Space</Text>
		</Language>
	</AdventureDesc>
		
	<Module filename="SOTP_Achievements.xml"/>
	<Module filename="SOTP_Benedict00.xml"/>
	<Module filename="SOTP_Benedict01.xml"/>
	<Module filename="SOTP_Benedict02.xml"/>
	<!-- Benedict03 is obsolete. -->
	<Module filename="SOTP_Benedict04.xml"/>
	<Module filename="SOTP_Benedict05.xml"/>
	<Module filename="SOTP_Benedict05A.xml"/>
	<Module filename="SOTP_Benedict06.xml"/>
	<Module filename="SOTP_Benedict07.xml"/>
	<Module filename="SOTP_Benedict08.xml"/>
	<Module filename="SOTP_BenedictStoryArc.xml"/>
	<Module filename="SOTP_Elysium.xml"/>
	<Module filename="SOTP_Heretic00.xml"/>
	<Module filename="SOTP_Heretic01.xml"/>
	<Module filename="SOTP_Heretic02.xml"/>
	<Module filename="SOTP_Heretic03.xml"/>
	<Module filename="SOTP_Heretic04.xml"/>
	<Module filename="SOTP_Heretic05.xml"/>
	<Module filename="SOTP_Heretic06.xml"/>
	<Module filename="SOTP_Heretic07.xml"/>
	<Module filename="SOTP_Heretic08.xml"/>
	<Module filename="SOTP_Huaramarca.xml"/>
	<Module filename="SOTP_HuaramarcaMission01.xml"/>
	<Module filename="SOTP_HuaramarcaMission02.xml"/>
	<Module filename="SOTP_HuaramarcaMission03.xml"/>
	<Module filename="SOTP_HuaramarcaMission04.xml"/>
	<Module filename="SOTP_HuaramarcaMission05.xml"/>
	<Module filename="SOTP_HuaramarcaMission06.xml"/>
	<Module filename="SOTP_HuaramarcaMission07.xml"/>
	<Module filename="SOTP_Part1Compatibility.xml"/>
	<Module filename="SOTP_PlayerShips.xml"/>
	<Module filename="SOTP_Psych00.xml"/>
	<Module filename="SOTP_Psych01.xml"/>
		
<!-- ADVENTURE MAP -->

	<SystemMap UNID="&SOTP_unidPartISystemMap;"
			displayOn="&HS_smHumanSpace;"
			>
		<Properties>
			<Global id="hereticTraveler"></Global>
			<Global id="interstellarTraveler"></Global>
			<Global id="outerRealmTraveler"></Global>
		</Properties>
			
		<TopologyCreator>
			<Node ID="NewBeyondMainline"/>
			<Stargate from="CP:Outbound" to="SK:Inbound"/>
			
			<Node ID="UngovernedTerritoriesMainline"/>
			<Stargate from="C9:Outbound" to="A1:Inbound"/>
			
			<Node ID="OuterRealmMainline"/>
			<Stargate from="G2:Outbound" to="EndGame"/>
			
			<Node ID="Elysium"/>
		</TopologyCreator>
		
		<Node	ID="EndGame"
				endGame="true"
				endGameReason="leftHumanSpace"
				epitaph="left Human Space on a journey to the Galactic Core"
				>
		</Node>

		<Node ID="Elysium">
			<System
					UNID=				"&HS_ssElysium;"
					name=				"Elysium"
					level=				"5"
					/>

			<Stargates>
				<Stargate name="SE" to="SE:Outbound"/>
				<Stargate name="BA" to="BA:Outbound"/>
				<Stargate name="SK" to="SK:Outbound"/>
				<Stargate name="C6" to="C6:Outbound"/>
				<Stargate name="CD" to="CD:Outbound"/>
				<Stargate name="C9" to="C9:Outbound"/>
				<Stargate name="EC" to="EC:Outbound"/>
				<Stargate name="PJ" to="PJ:Outbound"/>
				<Stargate name="G2" to="G2:Inbound"/>
			</Stargates>
		</Node>

		<Events>
			<OnGlobalUniverseCreated>
				(block Nil
					;	Several well-known sites are known to the player at the beginning
					;	of the game. This will hopefully give the player various landmarks
					;	to try to reach.

					(unvSetObjectKnown 'SE "t +unid:&HS_stStartonEridani;;")
					(unvSetObjectKnown 'BA "t +unid:&HS_stBattleArena;;")
					(unvSetObjectKnown 'SK "tV +unid:&HS_stStKatsArcology;;")
					(unvSetObjectKnown 'CD "t +unid:&HS_stCathedralOfDomina;;")
					;	LATER: Add Jiang's Star
					(unvSetObjectKnown 'PJ "t +unid:&HS_stPointJuno;;")
					(unvSetObjectKnown 'A7 "t +unid:&HS_stCommonwealthSettlement;;")
					)
			</OnGlobalUniverseCreated>

			<OnGlobalPlayerEnteredSystem>
				(switch
					(= (sysGetNode) (obj@ gPlayerShip 'startingSystem))
						Nil

					;	Achievement when we leave our home system.

					(not (typ@ gType 'interstellarTraveler))
						(block ()
							(typSet@ gType 'interstellarTraveler True)
							(unvSetAchievement 'sotp.interstellarTraveler)
							)

					;	Achievement when we first enter the Outer Realm

					(and (sysHasAttribute 'outerRealm)
							(not (typ@ gType 'outerRealmTraveler))
							)
						(block ()
							(typSet@ gType 'outerRealmTraveler True)
							(unvSetAchievement 'humanSpace.outerRealm)
							)

					;	Achievement when we reach Heretic

					(and (= (sysGetNode) 'G2)
							(not (typ@ gType 'hereticTraveler))
							)
						(block ()
							(typSet@ gType 'hereticTraveler True)
							(unvSetAchievement 'humanSpace.heretic)
							)
					)
			</OnGlobalPlayerEnteredSystem>
		</Events>
	</SystemMap>

<!-- SPECIAL MISSIONS -->
	
	<MissionType UNID="&SOTP_msReachGalacticCore;"
			name=				"Reach Galactic Core"
			attributes=			""

			level=				"10"
				 
			noDebrief=			"true"
			noStats=			"true"
			>
		
		<Image imageID="&SOTP_rsGalacticCoreMissionTile;"	imageWidth="384" imageHeight="192"/>

		<Language>
			<Text id="Name">
				Reach the Galactic Core
			</Text>
			<Text id="Summary">

				When the dream came, you knew Domina had chosen you. 
				You would sacrifice everything for the chance She offered: 
				to join Her at the Galactic Core, the eternal temple of the gods.

				Leaving your former life behind, you begin the long journey. 
				No matter what obstacles lie in your path you will not fail Domina.
				You will reach the Galactic Core.

				System: Unknown\n
				Payment: Unknown

			</Text>
		</Language>
	</MissionType>

<!-- RESOURCES -->

	<Image UNID="&HS_rsPart1Cover;"				bitmap="Resources\Part1Cover.jpg"			loadOnUse="true" />
	<Image UNID="&HS_rsProlog1;"					bitmap="Resources\Prolog1.jpg"				loadOnUse="true" />
	<Image UNID="&SOTP_rsGalacticCoreMissionTile;"	bitmap="Resources\GalacticCoreMissionTile.jpg"				loadOnUse="true" />

</TranscendenceAdventure>
